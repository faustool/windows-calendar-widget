<Window x:Class="M365CalendarApp.WPF.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Settings - M365 Calendar" 
        Height="500" 
        Width="450"
        MinHeight="400"
        MinWidth="400"
        Background="{DynamicResource BackgroundBrush}"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResize">
    
    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <TextBlock Grid.Row="0"
                   Text="Settings"
                   FontSize="24"
                   FontWeight="SemiBold"
                   Foreground="{DynamicResource ForegroundBrush}"
                   Margin="0,0,0,20"/>

        <!-- Settings Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>
                
                <!-- Application Settings -->
                <GroupBox Header="Application" 
                          Foreground="{DynamicResource ForegroundBrush}"
                          BorderBrush="{DynamicResource BorderBrush}"
                          Margin="0,0,0,15">
                    <StackPanel Margin="10">
                        <CheckBox x:Name="StartWithWindowsCheckBox"
                                  Content="Start with Windows"
                                  Foreground="{DynamicResource ForegroundBrush}"
                                  Margin="0,5"
                                  Checked="StartWithWindowsCheckBox_Checked"
                                  Unchecked="StartWithWindowsCheckBox_Unchecked"/>
                        
                        <CheckBox x:Name="StayOnTopCheckBox"
                                  Content="Always stay on top"
                                  Foreground="{DynamicResource ForegroundBrush}"
                                  Margin="0,5"
                                  Checked="StayOnTopCheckBox_Checked"
                                  Unchecked="StayOnTopCheckBox_Unchecked"/>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,10,0,5">
                            <TextBlock Text="Default Theme:"
                                      Foreground="{DynamicResource ForegroundBrush}"
                                      VerticalAlignment="Center"
                                      Margin="0,0,10,0"/>
                            <ComboBox x:Name="DefaultThemeComboBox"
                                     Width="120"
                                     SelectionChanged="DefaultThemeComboBox_SelectionChanged">
                                <ComboBoxItem Content="Light"/>
                                <ComboBoxItem Content="Dark"/>
                                <ComboBoxItem Content="System"/>
                            </ComboBox>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <!-- Calendar Settings -->
                <GroupBox Header="Calendar" 
                          Foreground="{DynamicResource ForegroundBrush}"
                          BorderBrush="{DynamicResource BorderBrush}"
                          Margin="0,0,0,15">
                    <StackPanel Margin="10">
                        <StackPanel Orientation="Horizontal" Margin="0,5">
                            <TextBlock Text="Refresh Interval:"
                                      Foreground="{DynamicResource ForegroundBrush}"
                                      VerticalAlignment="Center"
                                      Margin="0,0,10,0"/>
                            <ComboBox x:Name="RefreshIntervalComboBox"
                                     Width="120"
                                     SelectionChanged="RefreshIntervalComboBox_SelectionChanged">
                                <ComboBoxItem Content="5 minutes" Tag="5"/>
                                <ComboBoxItem Content="15 minutes" Tag="15"/>
                                <ComboBoxItem Content="30 minutes" Tag="30"/>
                                <ComboBoxItem Content="1 hour" Tag="60"/>
                            </ComboBox>
                        </StackPanel>
                        
                        <CheckBox x:Name="ShowAllDayEventsCheckBox"
                                  Content="Show all-day events"
                                  Foreground="{DynamicResource ForegroundBrush}"
                                  Margin="0,5"
                                  Checked="ShowAllDayEventsCheckBox_Checked"
                                  Unchecked="ShowAllDayEventsCheckBox_Unchecked"/>
                        
                        <CheckBox x:Name="ShowPrivateEventsCheckBox"
                                  Content="Show private events"
                                  Foreground="{DynamicResource ForegroundBrush}"
                                  Margin="0,5"
                                  Checked="ShowPrivateEventsCheckBox_Checked"
                                  Unchecked="ShowPrivateEventsCheckBox_Unchecked"/>
                        
                        <StackPanel Orientation="Horizontal" Margin="0,10,0,5">
                            <TextBlock Text="Time Format:"
                                      Foreground="{DynamicResource ForegroundBrush}"
                                      VerticalAlignment="Center"
                                      Margin="0,0,10,0"/>
                            <ComboBox x:Name="TimeFormatComboBox"
                                     Width="120"
                                     SelectionChanged="TimeFormatComboBox_SelectionChanged">
                                <ComboBoxItem Content="12-hour" Tag="12h"/>
                                <ComboBoxItem Content="24-hour" Tag="24h"/>
                            </ComboBox>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

                <!-- Authentication Settings -->
                <GroupBox Header="Authentication" 
                          Foreground="{DynamicResource ForegroundBrush}"
                          BorderBrush="{DynamicResource BorderBrush}"
                          Margin="0,0,0,15">
                    <StackPanel Margin="10">
                        <StackPanel Orientation="Horizontal" Margin="0,5">
                            <TextBlock Text="Client ID:"
                                      Foreground="{DynamicResource ForegroundBrush}"
                                      VerticalAlignment="Center"
                                      Margin="0,0,10,0"
                                      Width="80"/>
                            <TextBox x:Name="ClientIdTextBox"
                                    Width="250"
                                    Text="9b0059d1-a22e-4ed9-854b-b3304df51816"
                                    TextChanged="ClientIdTextBox_TextChanged"/>
                        </StackPanel>
                        
                        <TextBlock Text="Note: You need to register your application in Azure AD to get a Client ID"
                                  Foreground="{DynamicResource ForegroundBrush}"
                                  FontSize="10"
                                  Opacity="0.7"
                                  Margin="0,5"
                                  TextWrapping="Wrap"/>
                    </StackPanel>
                </GroupBox>

                <!-- Proxy Settings -->
                <GroupBox Header="Proxy Settings" 
                          Foreground="{DynamicResource ForegroundBrush}"
                          BorderBrush="{DynamicResource BorderBrush}"
                          Margin="0,0,0,15">
                    <StackPanel Margin="10">
                        <CheckBox x:Name="UseSystemProxyCheckBox"
                                  Content="Use system proxy settings"
                                  Foreground="{DynamicResource ForegroundBrush}"
                                  Margin="0,5"
                                  IsChecked="True"
                                  Checked="UseSystemProxyCheckBox_Checked"
                                  Unchecked="UseSystemProxyCheckBox_Unchecked"/>
                        
                        <StackPanel x:Name="CustomProxyPanel" IsEnabled="False" Margin="0,10,0,0">
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <TextBlock Text="Proxy Address:"
                                          Foreground="{DynamicResource ForegroundBrush}"
                                          VerticalAlignment="Center"
                                          Margin="0,0,10,0"
                                          Width="100"/>
                                <TextBox x:Name="ProxyAddressTextBox"
                                        Width="200"
                                        TextChanged="ProxyAddressTextBox_TextChanged"/>
                            </StackPanel>
                            
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <TextBlock Text="Username:"
                                          Foreground="{DynamicResource ForegroundBrush}"
                                          VerticalAlignment="Center"
                                          Margin="0,0,10,0"
                                          Width="100"/>
                                <TextBox x:Name="ProxyUsernameTextBox"
                                        Width="200"
                                        TextChanged="ProxyUsernameTextBox_TextChanged"/>
                            </StackPanel>
                            
                            <StackPanel Orientation="Horizontal" Margin="0,5">
                                <TextBlock Text="Password:"
                                          Foreground="{DynamicResource ForegroundBrush}"
                                          VerticalAlignment="Center"
                                          Margin="0,0,10,0"
                                          Width="100"/>
                                <PasswordBox x:Name="ProxyPasswordBox"
                                            Width="200"
                                            PasswordChanged="ProxyPasswordBox_PasswordChanged"/>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>
                </GroupBox>

            </StackPanel>
        </ScrollViewer>

        <!-- Buttons -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right" 
                    Margin="0,20,0,0">
            <Button x:Name="SaveButton"
                    Content="Save"
                    Style="{StaticResource ModernButtonStyle}"
                    Background="{DynamicResource AccentBrush}"
                    Foreground="White"
                    Margin="0,0,10,0"
                    Padding="20,8"
                    Click="SaveButton_Click"/>
            <Button x:Name="CancelButton"
                    Content="Cancel"
                    Style="{StaticResource ModernButtonStyle}"
                    Padding="20,8"
                    Click="CancelButton_Click"/>
        </StackPanel>
    </Grid>
</Window>