<Window x:Class="M365CalendarApp.WPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="M365 Calendar" 
        Height="600" 
        Width="400"
        MinHeight="400"
        MinWidth="300"
        Background="{DynamicResource BackgroundBrush}"
        Topmost="True"
        WindowStyle="SingleBorderWindow"
        ResizeMode="CanResize"
        IsManipulationEnabled="True">
    
    <Window.Resources>
        <!-- Calendar Item Style -->
        <Style x:Key="CalendarItemStyle" TargetType="Border">
            <Setter Property="Background" Value="{DynamicResource SecondaryBrush}"/>
            <Setter Property="BorderBrush" Value="{DynamicResource BorderBrush}"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Margin" Value="8,4"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header with Login/Theme Controls -->
        <Border Grid.Row="0" 
                Background="{DynamicResource AccentBrush}" 
                Padding="12,8">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0"
                          Text="M365 Calendar"
                          Foreground="White"
                          FontSize="16"
                          FontWeight="SemiBold"
                          VerticalAlignment="Center"/>
                
                <Button Grid.Column="1"
                        x:Name="ThemeToggleButton"
                        Content="🌙"
                        Background="Transparent"
                        Foreground="White"
                        BorderThickness="0"
                        FontSize="16"
                        Width="32"
                        Height="32"
                        Margin="4,0"
                        Cursor="Hand"
                        Click="ThemeToggleButton_Click"
                        ToolTip="Toggle Theme"/>
                
                <Button Grid.Column="2"
                        x:Name="SettingsButton"
                        Content="⚙️"
                        Background="Transparent"
                        Foreground="White"
                        BorderThickness="0"
                        FontSize="16"
                        Width="32"
                        Height="32"
                        Margin="4,0"
                        Cursor="Hand"
                        Click="SettingsButton_Click"
                        ToolTip="Settings"/>
                
                <Button Grid.Column="3"
                        x:Name="LoginButton"
                        Content="Login"
                        Background="White"
                        Foreground="{DynamicResource AccentBrush}"
                        BorderThickness="0"
                        FontSize="12"
                        FontWeight="SemiBold"
                        Padding="12,4"
                        Margin="4,0,0,0"
                        Style="{StaticResource ModernButtonStyle}"
                        Click="LoginButton_Click"/>
            </Grid>
        </Border>

        <!-- Date Navigation -->
        <Grid Grid.Row="1" Margin="12,8">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>
            
            <Button Grid.Column="0"
                    x:Name="PreviousDayButton"
                    Content="◀"
                    Style="{StaticResource NavigationArrowStyle}"
                    Click="PreviousDayButton_Click"
                    HorizontalAlignment="Left"
                    VerticalAlignment="Center"/>
            
            <TextBlock Grid.Column="1"
                      x:Name="CurrentDateText"
                      Text="Today, December 9, 2024"
                      FontSize="18"
                      FontWeight="SemiBold"
                      Foreground="{DynamicResource ForegroundBrush}"
                      HorizontalAlignment="Center"
                      VerticalAlignment="Center"
                      TextAlignment="Center"/>
            
            <Button Grid.Column="2"
                    x:Name="NextDayButton"
                    Content="▶"
                    Style="{StaticResource NavigationArrowStyle}"
                    Click="NextDayButton_Click"
                    HorizontalAlignment="Right"
                    VerticalAlignment="Center"/>
        </Grid>

        <!-- Calendar Events -->
        <ScrollViewer Grid.Row="2" 
                      x:Name="EventsScrollViewer"
                      VerticalScrollBarVisibility="Auto"
                      HorizontalScrollBarVisibility="Disabled"
                      Padding="4,0">
            <StackPanel x:Name="EventsPanel" Orientation="Vertical">
                <!-- Events will be populated here -->
                <Border Style="{StaticResource CalendarItemStyle}" Visibility="Collapsed">
                    <StackPanel>
                        <TextBlock Text="Sample Event"
                                  FontSize="14"
                                  FontWeight="SemiBold"
                                  Foreground="{DynamicResource ForegroundBrush}"/>
                        <TextBlock Text="9:00 AM - 10:00 AM"
                                  FontSize="12"
                                  Foreground="{DynamicResource ForegroundBrush}"
                                  Opacity="0.7"
                                  Margin="0,2,0,0"/>
                    </StackPanel>
                </Border>
            </StackPanel>
        </ScrollViewer>

        <!-- Status Bar -->
        <Border Grid.Row="3" 
                Background="{DynamicResource SecondaryBrush}"
                BorderBrush="{DynamicResource BorderBrush}"
                BorderThickness="0,1,0,0"
                Padding="12,4">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <TextBlock Grid.Column="0"
                          x:Name="StatusText"
                          Text="Ready"
                          FontSize="11"
                          Foreground="{DynamicResource ForegroundBrush}"
                          VerticalAlignment="Center"/>
                
                <StackPanel Grid.Column="1" Orientation="Horizontal">
                    <TextBlock Text="Zoom: "
                              FontSize="11"
                              Foreground="{DynamicResource ForegroundBrush}"
                              VerticalAlignment="Center"/>
                    <TextBlock x:Name="ZoomText"
                              Text="100%"
                              FontSize="11"
                              Foreground="{DynamicResource ForegroundBrush}"
                              VerticalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>
    </Grid>
</Window>